<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Parhelia - Septagram</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <link rel="stylesheet" href="./css/stylesheet.css" type="text/css" />
    <script
      src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"
      type="text/javascript"
    ></script>
    <script src="./js/three.js"></script>
    <script src="./js/howler.js"></script>
    <script src="./js/util.js"></script>
    <script src="./js/spheremap.js"></script>
    <script src="./js/planet.js"></script>
    <script src="./js/material.js"></script>
    <script src="./js/main.js"></script>
  </head>
  <body>
    <div class="document">
      <div class="a1">
        <span class="bl t1">SEPTAGRAM</span>
      </div>
      <div class="a2"></div>
      <div class="b1 centered">
        <a href="#" id="playlink"><img id="play" src="img/play.svg"/></a>
      </div>
      <div class="b2 centered">
        <img id="septagram" src="img/septagram.svg" />
      </div>
      <div class="b3 centered">
        <img id="parhelia" src="img/parhelia.svg" />
      </div>
      <div class="b4 centered">
        <div class="tracklisting">
          <div class="info2">
            <img width="210px" src="./img/parheliawseptagram.svg">
            <br>
          </div>
          <div class="tracklabel">Track</div>
          <div class="trackrow trackrow01">
            <div class="track track01">Anthelion</div>
            <div class="trackcurrentlength trackcurrentlength01"></div>
            <div class="tracklength tracklength01">6:05</div>
          </div>

          <div class="trackrow trackrow02">
            <div class="track track02">Hiraeth</div>
            <div class="trackcurrentlength trackcurrentlength02"></div>
            <div class="tracklength tracklength02">5:48</div>
          </div>

          <div class="trackrow trackrow03">
            <div class="track track03">Penumbra</div>
            <div class="trackcurrentlength trackcurrentlength03"></div>
            <div class="tracklength tracklength03">1:58</div>
          </div>

          <div class="trackrow trackrow04">
            <div class="track track04">Umbra</div>
            <div class="trackcurrentlength trackcurrentlength04"></div>
            <div class="tracklength tracklength04">2:55</div>
          </div>

          <div class="trackrow trackrow05">
            <div class="track track05">Antumbra</div>
            <div class="trackcurrentlength trackcurrentlength05"></div>
            <div class="tracklength tracklength05">5:41</div>
          </div>

          <br><br>
          <div class="info">
            Please visit <u>schoch.co.nz/parhelia</u> to see more.
            <br><br>Press <span class="button">spacebar</span> to exit.
        </div>
      </div>
    </div>

    <script type="text/javascript">
      var timetochange = 1500;
      /*
                    function main(){
                  let CVD = null; // return of Canvas2DDisplay

                  JEEFACEFILTERAPI.init({
                   canvasId: 'jeeFaceFilterCanvas',
                   NNCPath: 'neuralNets/', // root of NN_DEFAULT.json file
                   callbackReady: function(errCode, spec){
                     if (errCode){
                       console.log('AN ERROR HAPPENS. SORRY BRO :( . ERR =', errCode);
                       return;
                     }

                     console.log('INFO: JEEFACEFILTERAPI IS READY');
                     CVD = JeelizCanvas2DHelper(spec);
                     CVD.ctx.strokeStyle = 'yellow';
                   },

                   // called at each render iteration (drawing loop):
                   callbackTrack: function(detectState){
                     if (detectState.detected>0.6){
                       temp = detectState.s;
                       temp = temp * 100;
                       temp = 100 - temp;
                       temp = temp / 100;
                       temp = temp * 1500
                       if (temp <= 0){
                         temp = 1500;
                       }
                       window.timetochange = temp;
                    } else {
                      window.timetochange = 1500;
                    }
                   }
                  });



                  };



                  $("img").attr("draggable", false);
                  $("svg").attr("draggable", false);
                  $("div").attr("draggable", false);
                  $("img").on("dragstart", function(event) {
                    event.preventDefault();
                  });
                  $("svg").on("dragstart", function(event) {
                    event.preventDefault();
                  });

                  */

      /*
                        var inputPrompt = prompt("Please enter a string.", "parhelia");
                        var inputPrompt = inputPrompt.toLowerCase();
                        var inputPromptChars = [];
                        var inputPromptChars = inputPrompt.split("");
                        inputPromptChars.forEach(charFunc);

                        function charFunc(item, index) {
                          if (item == "/") {
                            $(".a2").append("<br><br>");
                          } else if (item == " ") {
                            $(".a2").append("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
                          } else {
                            $(".a2").append(
                              "<img class='svganim " +
                                item +
                                " noselect' height='300px' width='300px;' src='/'>"
                            );
                          }
                        }

                        var letter = "a";
                        var file = "";
                        var letters = [
                          "a",
                          "b",
                          "c",
                          "d",
                          "e",
                          "f",
                          "g",
                          "h",
                          "i",
                          "j",
                          "k",
                          "l",
                          "m",
                          "n",
                          "o",
                          "p",
                          "q",
                          "r",
                          "s",
                          "t",
                          "u",
                          "v",
                          "w",
                          "x",
                          "y",
                          "z"
                        ];
                        var amounts = [
                          45,
                          43,
                          20,
                          38,
                          14,
                          30,
                          12,
                          14,
                          6,
                          13,
                          10,
                          5,
                          12,
                          7,
                          11,
                          8,
                          5,
                          10,
                          24,
                          18,
                          18,
                          18,
                          6,
                          5,
                          66,
                          16
                        ];

                        var obj = {};

                        for (var i = 0; i <= letters.length; i++) {
                          //   var file = "../../Scans/Outputs 2/output svgs/svgs/" + letters[i] + "/" + letters[i] + i + ".svg";
                    //  var index = letters[i];

                    //  fileArray.push(index:file);

                          var fileArray = [];
                          var key = letters[i];
                          for (var j = 0; j <= amounts[i]; j++) {
                            var file =
                              "../../Scans/Outputs 2/output svgs/svgs/" +
                              letters[i] +
                              "/" +
                              letters[i] +
                              j +
                              ".svg";
                            fileArray.push(file);
                          }
                          obj[key] = fileArray;
                        }

                        // console.log(Object.keys(obj));
                        // console.log(Object.keys(obj)[27]);


                        $(".svganim").each(function(timetochange) {
                          var sc = $(this)
                            .attr("class")
                            .split(" ")[1];
                          var urls = obj[sc];
                          // console.log("urls");
                          var this2 = $(this);
                          setInterval(function(timetochange) {
                            // console.log(sc);
                            var index = Math.floor(Math.random() * urls.length) + 1;
                            var newUrl = urls[index];
                            // console.log(timetochange);
                            $(this2).attr("src", newUrl);
                          }, 1000);
                        });

                  */
      var enableRotate = 0;
      window.enableRotate = 0;

      SS.main.main();

      var track_number = 0;
      var sound01 = new Howl({
        src: ["audio/01.mp3"],
        autoplay: false,
        preload: true,
        loop: false,
        volume: 1,
        onplay: function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow01").addClass("playing");
        },
        onend: function() {
          console.log("Track 2 playing");
          sound02.play();
        }
      });

      var sound02 = new Howl({
        src: ["audio/02.mp3"],
        autoplay: false,
        preload: true,
        loop: false,
        volume: 1,
        onend: function() {
          console.log("Track 3 playing");
          sound03.play();
        },
        onplay: function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow02").addClass("playing");
        }
      });

      var sound03 = new Howl({
        src: ["audio/03.mp3"],
        autoplay: false,
        preload: true,
        loop: false,
        volume: 1,
        onend: function() {
          console.log("Track 4 playing");
          sound04.play();
        },
        onplay: function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow03").addClass("playing");
        }
      });

      var sound04 = new Howl({
        src: ["audio/04.mp3"],
        autoplay: false,
        preload: true,
        loop: false,
        volume: 1,
        onend: function() {
          console.log("Track 5 playing");
          sound05.play();
        },
        onplay: function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow04").addClass("playing");
        }
      });

      var sound05 = new Howl({
        src: ["audio/05.mp3"],
        autoplay: false,
        preload: true,
        loop: false,
        volume: 1,
        onend: function() {
          $("#renderer").fadeOut(3000, function() {
            editorCamera.cameraPos.x = 0;
            window.enableRotate = 0;
            window.style = "entryspin";
            $("#renderer").fadeIn(3000);
          });

          $(".b4").animate(
            {
              opacity: 0
            },
            1000
          );
          $(".b1").css("opacity", "0");
          $(".b1").css("display", "inherit");
          $("#renderer").fadeIn(500);
          $(".b1").animate(
            {
              opacity: 1
            },
            1000
          );
        },
        onplay: function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow05").addClass("playing");
        }
      });

      $(document).ready(function() {
        window.enableRotate = 0;
        // $("body").tilt({});
        /*
                    $("body").bind("keypress", function(e) {
                      if (e.which == 32) {

                        //var cameraPosYnew = window.cameraPosY;
                        //var cameraPosXnew = window.cameraPosX;
                        //var cameraPosZnew = window.cameraPosZ;
                        //while (cameraPosYnew != window.cameraPosY)
                      }
                    });
      */
        $("body").bind("keypress", function(e) {
          if (e.which == 32 || e.which == 13) {
            sound01.stop();
            sound02.stop();
            sound03.stop();
            sound04.stop();
            sound05.stop();
            $("#renderer").fadeOut(3000, function() {
              editorCamera.cameraPos.x = 0;
              window.enableRotate = 0;
              window.style = "classicspin";
            });

            $(".b4").animate(
              {
                opacity: 0
              },
              1000
            );
            $(".b1").css("opacity", "0");
            $(".b1").css("display", "inherit");
            setTimeout(function(){
              $(".b1").animate(
              {
                opacity: 1
              },
              1000
            );
          }, 3000);
          }
        });

        var press = jQuery.Event("keypress");
press.ctrlKey = false;
press.which = 32;
$(".button").trigger(press);

        $(".b1").animate(
          {
            opacity: 1
          },
          3000
        );

        $("#playlink").click(function() {
          $(".b1").animate(
            {
              opacity: 0
            },
            1000,
            function() {
              $("#renderer").fadeIn(3000, function(){
                editorCamera.cameraPos.x = 0;
              window.style = "entryspin";
            window.enableRotate = 1;
            });

              $(".b1").css("display", "none");
              $(".trackrow01").addClass("playing");
              console.log("Track 1 playing");
              sound01.play();
              $(".b2").animate(
                {
                  opacity: 1
                },
                3000,
                function() {
                  $(".b2").animate(
                    {
                      opacity: 0
                    },
                    3000,
                    function() {
                      $(".b3").animate(
                        {
                          opacity: 1
                        },
                        3000,
                        function() {
                          $(".b3").animate(
                            {
                              opacity: 0
                            },
                            3000,
                            function() {
                              $(".b4").animate(
                                {
                                  opacity: 1
                                },
                                3000,
                                function() {
                                  // Animation complete.
                                }
                              );
                              editorCamera.cameraPos.x = 0;
                              window.style = "newspin";
                            }
                          );
                        }
                      );
                    }
                  );
                }
              );
            }
          );
        });

        $(".trackrow01").click(function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow01").addClass("playing");
          sound01.play();
          sound02.stop();
          sound03.stop();
          sound04.stop();
          sound05.stop();
        });

        $(".trackrow02").click(function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow02").addClass("playing");
          sound01.stop();
          sound02.play();
          sound03.stop();
          sound04.stop();
          sound05.stop();
        });

        $(".trackrow03").click(function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow03").addClass("playing");
          sound01.stop();
          sound02.stop();
          sound03.play();
          sound04.stop();
          sound05.stop();
        });

        $(".trackrow04").click(function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow04").addClass("playing");
          sound01.stop();
          sound02.stop();
          sound03.stop();
          sound04.play();
          sound05.stop();
        });

        $(".trackrow05").click(function() {
          $(".trackrow").each(function() {
            if ($(this).hasClass("playing")) {
              $(this).removeClass("playing");
            }
          });
          $(".trackrow05").addClass("playing");
          sound01.stop();
          sound02.stop();
          sound03.stop();
          sound04.stop();
          sound05.play();
        });

        function getTime(seconds) {
          //a day contains 60 * 60 * 24 = 86400 seconds
          //an hour contains 60 * 60 = 3600 seconds
          //a minut contains 60 seconds
          //the amount of seconds we have left
          var leftover = seconds;

          //how many full days fits in the amount of leftover seconds
          var days = Math.floor(leftover / 86400);

          //how many seconds are left
          leftover = leftover - days * 86400;

          //how many full hours fits in the amount of leftover seconds
          var hours = Math.floor(leftover / 3600);

          //how many seconds are left
          leftover = leftover - hours * 3600;

          //how many minutes fits in the amount of leftover seconds
          var minutes = Math.floor(leftover / 60);

          //how many seconds are left
          leftover = leftover - minutes * 60;
          leftover = Math.trunc(leftover);
          var n = leftover.toString().length;
          // console.log(n);
          // console.log(leftover);
          if (n == 1) {
            leftover = "0" + leftover;
          } else {
            leftover = leftover.toString();
          }
          // console.log(leftover);
          var minsec = minutes + ":" + leftover;
          return minsec;
        }

        window.setInterval(function() {
          if (sound01.playing()) {
            $(".trackcurrentlength").html("");
            $(".trackcurrentlength01").html(getTime(sound01.seek()) + "   /");
          } else if (sound02.playing()) {
            $(".trackcurrentlength").html("");
            $(".trackcurrentlength02").html(getTime(sound02.seek()) + "   /");
          } else if (sound03.playing()) {
            $(".trackcurrentlength").html("");
            $(".trackcurrentlength03").html(getTime(sound03.seek()) + "   /");
          } else if (sound04.playing()) {
            $(".trackcurrentlength").html("");
            $(".trackcurrentlength04").html(getTime(sound04.seek()) + "   /");
          } else if (sound05.playing()) {
            $(".trackcurrentlength").html("");
            $(".trackcurrentlength05").html(getTime(sound05.seek()) + "   /");
          }
        }, 1000);
      });
    </script>
  </body>
</html>
